/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => PertinentQuestions
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");

// src/Constants.ts
var AppSettings = class {
};
AppSettings.EMAIL_NL = `

`;
// Email new line
AppSettings.EMAIL_SOL = `  `;
//Email start of line
AppSettings.MAC_FOLDER_SEPARATOR = `/`;
AppSettings.ALL_CATEGORIES = "All Categories";
AppSettings.CREATE_PERTINENT_QUESTIONS = "Create Pertinent Questions";
AppSettings.SUBJECT_GOES_HERE = "SUBJECT GOES HERE";
AppSettings.FAO = "FAO";
AppSettings.CONTACTS_FILE_LOCATION = "Enter Contacts File Location";
AppSettings.CONTACTS_IMPORT_FILE = "Contacts Import File";

// main.ts
var DEFAULT_SETTINGS = {
  questionsFolder: "Questions",
  outputFolder: "Pertinent Questions",
  contactsFile: "contacts.csv"
};
function uniqByObject(array) {
  const result = [];
  let results = 0;
  for (const item of array) {
    let duplicate = false;
    for (let i = 0; i < result.length; i++) {
      if (result[i].emailAddress == item.emailAddress) {
        duplicate = true;
        console.log(`Duplicate contact found with email address ${item.emailAddress}`);
        break;
      }
      if (result[i].firstName == item.firstName && result[i].lastName == item.lastName) {
        duplicate = true;
        console.log(`Duplicate contact found with first and last name ${item.firstName} ${item.lastName}`);
        break;
      }
    }
    if (!duplicate) {
      result.push(item);
    }
  }
  return result;
}
var validateEmail = (email) => {
  try {
    return email.toLowerCase().match(
      /^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|.(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/
    );
  } catch (e) {
    console.log(`ERROR: Problem validating Email with ${email}`);
  }
  return false;
};
function validContact(contact) {
  let contactIsValid = true;
  if (contact == null || contact == void 0) {
    console.log("Invalid contact - null or undefined");
    contactIsValid = false;
  } else if (!validateEmail(contact.emailAddress)) {
    console.log(`Invalid contact - bad email: ${contact.emailAddress}`);
    contactIsValid = false;
  } else if (contact.firstName.length == 0) {
    console.log(`Invalid contact - no firstname provided`);
    contactIsValid = false;
  } else if (contact.lastName.length == 0) {
    console.log(`Invalid contact - no lastname provided`);
    contactIsValid = false;
  }
  return contactIsValid;
}
function fileExists(filePath, app) {
  const folderOrFile = app.vault.getAbstractFileByPath(filePath);
  if (folderOrFile instanceof import_obsidian.TFile) {
    console.log(`fileExists true for ${filePath}`);
    return true;
  }
  console.log(`fileExists false for ${filePath}`);
  return false;
}
function folderExists(filePath, app) {
  const folderOrFile = app.vault.getAbstractFileByPath(filePath);
  if (folderOrFile instanceof import_obsidian.TFolder) {
    return true;
  }
  return false;
}
var PertinentQuestions = class extends import_obsidian.Plugin {
  async onload() {
    await this.loadSettings();
    this.addCommand({
      id: "create-pertinent-questions",
      name: AppSettings.CREATE_PERTINENT_QUESTIONS,
      callback: async () => {
        const categories = [];
        this.findAllCategories().forEach((cat) => {
          categories.unshift(cat);
        });
        const contacts = await this.getAllContacts(this.settings.contactsFile);
        const suggestModal = new PertinentQuestionsSuggestModal(this.app, categories, contacts, this.settings.outputFolder, this.settings.questionsFolder).open();
      }
    });
    this.addSettingTab(new PertinentSettingTab(this.app, this));
  }
  // async getAllContacts(theContactFile: string): Promise<string[][] | null> {
  async getAllContacts(theContactFile) {
    const contacts = [];
    const theFileExists = fileExists(theContactFile, this.app);
    if (theFileExists) {
      const folderOrFile = this.app.vault.getAbstractFileByPath(theContactFile);
      if (folderOrFile instanceof import_obsidian.TFile) {
        const fileContents = await this.app.vault.cachedRead(folderOrFile);
        const fileLines = fileContents.split("\n");
        for (let j = 0; j < fileLines.length; j++) {
          const [title, firstName, lastName, emailAddress] = fileLines[j].split(",");
          const contact = { title, firstName, lastName, emailAddress };
          if (validContact(contact)) {
            contacts.unshift(contact);
          } else {
            console.log(`Invalid contact found - contact = ${contact}`);
          }
        }
        return uniqByObject(contacts);
      }
    }
    return contacts;
  }
  findAllCategories() {
    const categories = [];
    function extractSecondLevelFolder(str) {
      const regex = /\/([^\/]*)\//;
      const match = str.match(regex);
      return match ? match[1] : null;
    }
    const folderOrFile = this.app.vault.getAbstractFileByPath(this.settings.questionsFolder);
    let numFolders = 0;
    if (folderOrFile instanceof import_obsidian.TFolder) {
      for (let child of folderOrFile.children) {
        if (child instanceof import_obsidian.TFile) {
        } else {
          const categoryFolder = this.app.vault.getAbstractFileByPath(child.path);
          if (categoryFolder instanceof import_obsidian.TFolder) {
            for (let innerChild of categoryFolder.children) {
              if (innerChild instanceof import_obsidian.TFile) {
                const substring = extractSecondLevelFolder(innerChild.path);
                if (substring != null) {
                  console.log(`INFO: substring = ${substring}`);
                  if (!categories.contains(substring)) {
                    categories.unshift(substring);
                  }
                } else {
                  console.log(`Couldn't extract folder substring from ${innerChild.path}`);
                }
              }
            }
          }
        }
      }
      console.log(`numFolders=${numFolders}`);
    } else {
      console.log(`NOT AN INSTANCE OF TFolder instead it is ${folderOrFile}`);
    }
    return categories;
  }
  onunload() {
    console.log("Unloading PertinentQuestions plugin...");
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
};
var PertinentQuestionsSuggestModal = class extends import_obsidian.SuggestModal {
  constructor(app, categories, contacts, outputFolder, questionsFolder) {
    super(app);
    this.vault = app.vault;
    this.categories = categories;
    this.contacts = contacts;
    this.outputFolder = outputFolder;
    this.questionsFolder = questionsFolder;
  }
  // Returns all available suggestions.
  getSuggestions(query) {
    this.categories.sort();
    if (this.categories[0] != AppSettings.ALL_CATEGORIES) {
      const index = this.categories.indexOf(AppSettings.ALL_CATEGORIES);
      this.categories.unshift(AppSettings.ALL_CATEGORIES);
    }
    return this.categories.filter(
      (cat) => cat.toLowerCase().includes(query.toLowerCase())
    );
  }
  // Renders each suggestion item.
  renderSuggestion(cat, el) {
    el.createEl("div", { text: cat });
  }
  // Perform action on the selected suggestion.
  async onChooseSuggestion(cat, evt) {
    this.createFolder(this.outputFolder);
    if (cat != AppSettings.ALL_CATEGORIES) {
      this.categories = [cat];
    } else {
      this.categories.shift();
    }
    for (let j = 0; j < this.categories.length; j++) {
      console.log(`cat ${j} = ${this.categories[j]}`);
      let theQuestions = await this.getCategoryQuestions(this.categories[j]);
      if (theQuestions != null) {
        const theFolder = this.outputFolder.concat(AppSettings.MAC_FOLDER_SEPARATOR).concat(this.categories[j]);
        this.createFolder(theFolder);
        if (this.contacts.length > 0) {
          for (let i = 0; i < this.contacts.length; i++) {
            for (let k = 0; k < theQuestions.length; k++) {
              let theQuestion = theQuestions[k];
              this.writeQuestionFile(theQuestion, theFolder, this.categories[j], this.contacts.at(i));
            }
          }
        } else {
          for (let k = 0; k < theQuestions.length; k++) {
            let theQuestion = theQuestions[k];
            this.writeQuestionFile(theQuestion, theFolder, this.categories[j]);
          }
        }
      } else {
        console.log(`Couldn't read any file at ${this.questionsFolder} `);
      }
    }
  }
  async writeQuestionFile(theQuestion, theFolder, category, contact) {
    const theSubject = AppSettings.SUBJECT_GOES_HERE;
    const theFileFrontMatter = `---
publish: true
sent: false
category: ${category}
---

`;
    const theQuestionFile = theQuestion.split("\n", 2);
    const index = theQuestion.indexOf("\n");
    if (index != void 0) {
      theQuestion = theQuestion.substring(index, theQuestion.length - 1);
      let theBody = "";
      let theFileName = "";
      if (contact) {
        theBody = `${AppSettings.FAO} ${contact.title} ${contact.firstName} ${contact.lastName}${theQuestionFile[1]}`;
        theFileName = theFolder.concat("/").concat(contact.firstName + contact.lastName + "-" + theQuestionFile[0] + ".md");
      } else {
        theBody = `${AppSettings.FAO} ${theQuestionFile[1]}`;
        theFileName = theFolder.concat("/").concat(theQuestionFile[0] + ".md");
      }
      const theFileExists = fileExists(theFileName, this.app);
      if (!theFileExists) {
        let theFile = await this.createFile(theFileName, theFileFrontMatter);
        if (theFile instanceof import_obsidian.TFile) {
          let theContent = "";
          if (contact) {
            theContent = "```email\n".concat(`to: ${contact.emailAddress}
subject: ${theSubject}
body: "${theBody}"
`).concat("```");
          } else {
            theContent = "```email\n".concat(`to: someone@example.com
subject: ${theSubject}
body: "${theBody}"
`).concat("```");
          }
          try {
            await this.app.vault.append(theFile, theContent);
          } catch (e) {
            new import_obsidian.Notice("Could not append");
            console.log(`Could not append to file: ${theFileName} due to ${e}`);
          }
        } else {
          new import_obsidian.Notice("Could not create file");
          console.log(`Error - could not create file for ${theFileName}`);
        }
      } else {
      }
    }
  }
  async createFile(theFilePath, content) {
    try {
      const theFileExists = fileExists(theFilePath, this.app);
      if (theFileExists) {
        console.log(`WARNING:!!!!!!!!!FOUND FILE ${theFilePath}`);
        return null;
      }
      console.log(`INFO:Creating File ${theFilePath}`);
      const createdFile = await this.app.vault.create(theFilePath, content);
      return createdFile;
    } catch (e) {
      console.log(e);
    }
    return null;
  }
  async createFolder(theFolder) {
    try {
      if (!folderExists(theFolder, this.app)) {
        await this.app.vault.createFolder(theFolder);
        console.log("Created");
      }
    } catch (e) {
      console.log(e);
    }
  }
  // getCategoryQuestions adds the file name as the first line/element in the return string
  async getCategoryQuestions(category) {
    try {
      const folderOrFile = this.app.vault.getAbstractFileByPath(this.questionsFolder.concat(AppSettings.MAC_FOLDER_SEPARATOR.concat(category)));
      if (folderOrFile instanceof import_obsidian.TFolder) {
        const theQuestions = [];
        for (let child of folderOrFile.children) {
          if (child instanceof import_obsidian.TFile) {
            let theQuestionLines = await this.app.vault.cachedRead(child);
            const index = child.path.lastIndexOf(AppSettings.MAC_FOLDER_SEPARATOR);
            if (index != void 0) {
              let theQuestion = child.path + "\n";
              theQuestion = theQuestion.substring(index + 1, theQuestion.length - 4);
              const questionLines = theQuestionLines.split("\n");
              const lineStart = AppSettings.EMAIL_NL.concat(AppSettings.EMAIL_SOL);
              for (let i = 0; i < questionLines.length; i++) {
                theQuestion += lineStart.concat(questionLines[i]);
              }
              theQuestions.unshift(theQuestion);
            }
          }
        }
        return theQuestions;
      } else {
        console.log(`Expected folder in getCategoryQuestions param but sent ${this.questionsFolder.concat(category)}`);
        return null;
      }
    } catch (e) {
      console.log(e);
    }
    return null;
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};
var PertinentSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "General Settings" });
    new import_obsidian.Setting(containerEl).setName("Questions Folder").setDesc("Enter the Folder Location").addText((text) => text.setPlaceholder("Enter Questions Folder").setValue(this.plugin.settings.questionsFolder).onChange(async (value) => {
      console.log("Questions Location: " + value);
      this.plugin.settings.questionsFolder = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Questions Output Folder").setDesc("Enter the Pertinent Questions Output Folder Location").addText((text) => text.setPlaceholder("Enter Pertinent Questions Output Folder").setValue(this.plugin.settings.outputFolder).onChange(async (value) => {
      console.log("Output Folder Location: " + value);
      this.plugin.settings.outputFolder = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName(AppSettings.CONTACTS_IMPORT_FILE).setDesc("Enter the Contacts Import File Location").addText((text) => text.setPlaceholder(AppSettings.CONTACTS_FILE_LOCATION).setValue(this.plugin.settings.contactsFile).onChange(async (value) => {
      console.log("Contacts File Location: " + value);
      this.plugin.settings.contactsFile = value;
      await this.plugin.saveSettings();
    }));
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzcmMvQ29uc3RhbnRzLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBBcHAsIEVkaXRvciwgTWFya2Rvd25WaWV3LCBNb2RhbCwgU3VnZ2VzdE1vZGFsLCBOb3RpY2UsIFBsdWdpbiwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZywgVEZpbGUsIFRGb2xkZXIsIFdvcmtzcGFjZUxlYWYsIFZhdWx0IH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgbm9ybWFsaXplUGF0aCB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgQXBwU2V0dGluZ3MgYXMgQ29uc3RhbnRzIH0gZnJvbSBcInNyYy9Db25zdGFudHNcIjtcblxuLy8gaW1wb3J0IHsgQ1NWVmlldywgVklFV19UWVBFX0NTViB9IGZyb20gXCIuL3ZpZXdcIjtcblxuLy8gUmVtZW1iZXIgdG8gcmVuYW1lIHRoZXNlIGNsYXNzZXMgYW5kIGludGVyZmFjZXMhXG5cbmludGVyZmFjZSBQZXJ0aW5lbnRRdWVzdGlvbnNTZXR0aW5ncyB7XG5cdHF1ZXN0aW9uc0ZvbGRlcjogc3RyaW5nO1xuXHRvdXRwdXRGb2xkZXI6IHN0cmluZztcblx0Y29udGFjdHNGaWxlOiBzdHJpbmc7XG5cblxufVxuXG50eXBlIENvbnRhY3QgPSB7XG5cdHRpdGxlOiBzdHJpbmc7XG5cdGZpcnN0TmFtZTogc3RyaW5nO1xuXHRsYXN0TmFtZTogc3RyaW5nO1xuXHRlbWFpbEFkZHJlc3M6IHN0cmluZztcbn07XG5cblxuY29uc3QgREVGQVVMVF9TRVRUSU5HUzogUGVydGluZW50UXVlc3Rpb25zU2V0dGluZ3MgPSB7XG5cdHF1ZXN0aW9uc0ZvbGRlcjogJ1F1ZXN0aW9ucycsXG5cdG91dHB1dEZvbGRlcjogJ1BlcnRpbmVudCBRdWVzdGlvbnMnLFxuXHRjb250YWN0c0ZpbGU6ICdjb250YWN0cy5jc3YnXG5cbn1cblxuZnVuY3Rpb24gdW5pcUJ5T2JqZWN0KGFycmF5OiBDb250YWN0W10pOiBDb250YWN0W10ge1xuXHRjb25zdCByZXN1bHQ6IENvbnRhY3RbXSA9IFtdO1xuXHRsZXQgcmVzdWx0cyA9IDA7XG4gICAgZm9yIChjb25zdCBpdGVtIG9mIGFycmF5KSB7XG5cdFx0bGV0IGR1cGxpY2F0ZSA9IGZhbHNlO1xuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgcmVzdWx0Lmxlbmd0aDsgaSsrKXtcblx0XHRcdGlmIChyZXN1bHRbaV0uZW1haWxBZGRyZXNzID09IGl0ZW0uZW1haWxBZGRyZXNzKXtcblx0XHRcdFx0ZHVwbGljYXRlID0gdHJ1ZTtcblx0XHRcdFx0Y29uc29sZS5sb2coYER1cGxpY2F0ZSBjb250YWN0IGZvdW5kIHdpdGggZW1haWwgYWRkcmVzcyAke2l0ZW0uZW1haWxBZGRyZXNzfWApO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdH1cblx0XHRcdGlmICgocmVzdWx0W2ldLmZpcnN0TmFtZSA9PSBpdGVtLmZpcnN0TmFtZSkgJiYgKHJlc3VsdFtpXS5sYXN0TmFtZSA9PSBpdGVtLmxhc3ROYW1lKSl7XG5cdFx0XHRcdGR1cGxpY2F0ZSA9IHRydWU7XG5cdFx0XHRcdGNvbnNvbGUubG9nKGBEdXBsaWNhdGUgY29udGFjdCBmb3VuZCB3aXRoIGZpcnN0IGFuZCBsYXN0IG5hbWUgJHtpdGVtLmZpcnN0TmFtZX0gJHtpdGVtLmxhc3ROYW1lfWApO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdH1cblx0XHR9XG5cdFx0aWYgKCFkdXBsaWNhdGUpe1xuXHRcdFx0cmVzdWx0LnB1c2goaXRlbSk7XG5cdFx0fVxuICAgIH1cblxuICAgIHJldHVybiByZXN1bHQ7XG59XG5jb25zdCB2YWxpZGF0ZUVtYWlsID0gKGVtYWlsOiBzdHJpbmcpID0+IHtcblx0dHJ5e1xuXHRcdHJldHVybiBlbWFpbFxuXHRcdC50b0xvd2VyQ2FzZSgpXG5cdFx0Lm1hdGNoKFxuXHRcdCAgL14oKFtePD4oKVtcXF1cXFxcLiw7Olxcc0BcIl0rKFxcLltePD4oKVtcXF1cXFxcLiw7Olxcc0BcIl0rKSopfC4oXCIuK1wiKSlAKChcXFtbMC05XXsxLDN9XFwuWzAtOV17MSwzfVxcLlswLTldezEsM31cXC5bMC05XXsxLDN9XFxdKXwoKFthLXpBLVpcXC0wLTldK1xcLikrW2EtekEtWl17Mix9KSkkL1xuXHRcdCk7XG5cdH1jYXRjaCAoZSl7XG5cdFx0Y29uc29sZS5sb2coYEVSUk9SOiBQcm9ibGVtIHZhbGlkYXRpbmcgRW1haWwgd2l0aCAke2VtYWlsfWApO1xuXHR9XG5yZXR1cm4gZmFsc2U7XG4gIH07XG5cbmZ1bmN0aW9uIHZhbGlkQ29udGFjdCAoY29udGFjdDogQ29udGFjdCk6IGJvb2xlYW57XG5cdGxldCBjb250YWN0SXNWYWxpZCA9IHRydWU7XG5cdGlmIChjb250YWN0ID09IG51bGwgfHwgY29udGFjdCA9PSB1bmRlZmluZWQpe1xuXHRcdGNvbnNvbGUubG9nKFwiSW52YWxpZCBjb250YWN0IC0gbnVsbCBvciB1bmRlZmluZWRcIik7XG5cdFx0Y29udGFjdElzVmFsaWQgPSBmYWxzZTtcblx0fWVsc2UgaWYgKCF2YWxpZGF0ZUVtYWlsKGNvbnRhY3QuZW1haWxBZGRyZXNzKSl7XG5cdFx0Y29uc29sZS5sb2coYEludmFsaWQgY29udGFjdCAtIGJhZCBlbWFpbDogJHtjb250YWN0LmVtYWlsQWRkcmVzc31gKTtcblx0XHRjb250YWN0SXNWYWxpZCA9IGZhbHNlO1xuXHR9ZWxzZSBpZiAoY29udGFjdC5maXJzdE5hbWUubGVuZ3RoID09IDApe1xuXHRcdGNvbnNvbGUubG9nKGBJbnZhbGlkIGNvbnRhY3QgLSBubyBmaXJzdG5hbWUgcHJvdmlkZWRgKTtcblx0XHRjb250YWN0SXNWYWxpZCA9IGZhbHNlO1xuXHR9ZWxzZSBpZiAoY29udGFjdC5sYXN0TmFtZS5sZW5ndGggPT0gMCl7XG5cdFx0Y29uc29sZS5sb2coYEludmFsaWQgY29udGFjdCAtIG5vIGxhc3RuYW1lIHByb3ZpZGVkYCk7XG5cdFx0Y29udGFjdElzVmFsaWQgPSBmYWxzZTtcblx0fVxuXHRcblx0cmV0dXJuIGNvbnRhY3RJc1ZhbGlkO1xufVxuXG5mdW5jdGlvbiBmaWxlRXhpc3RzKGZpbGVQYXRoOiBzdHJpbmcsIGFwcDogQXBwKTogYm9vbGVhbiB7XG5cdGNvbnN0IGZvbGRlck9yRmlsZSA9IGFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZVBhdGgpO1xuXG5cdGlmIChmb2xkZXJPckZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xuXHRcdGNvbnNvbGUubG9nKGBmaWxlRXhpc3RzIHRydWUgZm9yICR7ZmlsZVBhdGh9YCk7XG5cdFx0cmV0dXJuIHRydWU7XG5cdH1cblx0Y29uc29sZS5sb2coYGZpbGVFeGlzdHMgZmFsc2UgZm9yICR7ZmlsZVBhdGh9YCk7XG5cdHJldHVybiBmYWxzZTtcblxufVxuXG5mdW5jdGlvbiBmb2xkZXJFeGlzdHMoZmlsZVBhdGg6IHN0cmluZywgYXBwOiBBcHApOiBib29sZWFuIHtcblx0Y29uc3QgZm9sZGVyT3JGaWxlID0gYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaWxlUGF0aCk7XG5cblx0aWYgKGZvbGRlck9yRmlsZSBpbnN0YW5jZW9mIFRGb2xkZXIpIHtcblx0XHRyZXR1cm4gdHJ1ZTtcblx0fVxuXHRyZXR1cm4gZmFsc2U7XG5cbn1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUGVydGluZW50UXVlc3Rpb25zIGV4dGVuZHMgUGx1Z2luIHtcblx0c2V0dGluZ3M6IFBlcnRpbmVudFF1ZXN0aW9uc1NldHRpbmdzO1xuXG5cblxuXHRhc3luYyBvbmxvYWQoKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0YXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcblxuXHRcdC8vIEFkZCBjb21tYW5kIHRvIGxhdW5jaCBBc2sgUGVydGluZW50IFF1ZXN0aW9uc1xuXHRcdHRoaXMuYWRkQ29tbWFuZCh7XG5cdFx0XHRpZDogJ2NyZWF0ZS1wZXJ0aW5lbnQtcXVlc3Rpb25zJyxcblx0XHRcdG5hbWU6IENvbnN0YW50cy5DUkVBVEVfUEVSVElORU5UX1FVRVNUSU9OUyxcblx0XHRcdGNhbGxiYWNrOiBhc3luYyAoKSA9PiB7XG5cdFx0XHRcdGNvbnN0IGNhdGVnb3JpZXM6IHN0cmluZ1tdID0gW107XG5cdFx0XHRcdHRoaXMuZmluZEFsbENhdGVnb3JpZXMoKS5mb3JFYWNoKGNhdCA9PiB7XG5cdFx0XHRcdFx0Y2F0ZWdvcmllcy51bnNoaWZ0KGNhdCk7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdGNvbnN0IGNvbnRhY3RzOiBDb250YWN0W10gPSBhd2FpdCB0aGlzLmdldEFsbENvbnRhY3RzKHRoaXMuc2V0dGluZ3MuY29udGFjdHNGaWxlKTtcblxuXHRcdFx0XHRjb25zdCBzdWdnZXN0TW9kYWwgPSBuZXcgUGVydGluZW50UXVlc3Rpb25zU3VnZ2VzdE1vZGFsKHRoaXMuYXBwLCBjYXRlZ29yaWVzLCBjb250YWN0cywgdGhpcy5zZXR0aW5ncy5vdXRwdXRGb2xkZXIsIHRoaXMuc2V0dGluZ3MucXVlc3Rpb25zRm9sZGVyKS5vcGVuKCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0Ly8gVGhpcyBhZGRzIGEgc2V0dGluZ3MgdGFiIHNvIHRoZSB1c2VyIGNhbiBjb25maWd1cmUgdmFyaW91cyBhc3BlY3RzIG9mIHRoZSBwbHVnaW5cblx0XHR0aGlzLmFkZFNldHRpbmdUYWIobmV3IFBlcnRpbmVudFNldHRpbmdUYWIodGhpcy5hcHAsIHRoaXMpKTtcblx0fVxuXG5cblxuXG5cdC8vIGFzeW5jIGdldEFsbENvbnRhY3RzKHRoZUNvbnRhY3RGaWxlOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZ1tdW10gfCBudWxsPiB7XG5cdFx0YXN5bmMgZ2V0QWxsQ29udGFjdHModGhlQ29udGFjdEZpbGU6IHN0cmluZyk6IFByb21pc2U8Q29udGFjdFtdPiB7XG5cdFxuXHRcdGNvbnN0IGNvbnRhY3RzOiBDb250YWN0W10gPSBbXTtcblxuXHRcdGNvbnN0IHRoZUZpbGVFeGlzdHMgPSAgZmlsZUV4aXN0cyh0aGVDb250YWN0RmlsZSwgdGhpcy5hcHApO1xuXHRcdGlmICh0aGVGaWxlRXhpc3RzKSB7XG5cdFx0XHRjb25zdCBmb2xkZXJPckZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgodGhlQ29udGFjdEZpbGUpO1xuXG5cdFx0XHRpZiAoZm9sZGVyT3JGaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcblx0XHRcdFx0Y29uc3QgZmlsZUNvbnRlbnRzOiBzdHJpbmcgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5jYWNoZWRSZWFkKGZvbGRlck9yRmlsZSk7XG5cdFx0XHRcdGNvbnN0IGZpbGVMaW5lcyA9IGZpbGVDb250ZW50cy5zcGxpdChcIlxcblwiKTtcblxuXHRcdFx0XHRmb3IgKGxldCBqID0gMDsgaiA8IGZpbGVMaW5lcy5sZW5ndGg7IGorKykge1xuXHRcdFx0XHRcdGNvbnN0IFt0aXRsZSwgZmlyc3ROYW1lLCBsYXN0TmFtZSwgZW1haWxBZGRyZXNzXSA9IGZpbGVMaW5lc1tqXS5zcGxpdChcIixcIik7XG5cdFx0XHRcdFx0Y29uc3QgY29udGFjdDogQ29udGFjdCA9IHsgdGl0bGUsIGZpcnN0TmFtZSwgbGFzdE5hbWUsIGVtYWlsQWRkcmVzcyB9O1xuXG5cdFx0XHRcdFx0aWYgKHZhbGlkQ29udGFjdChjb250YWN0KSl7XG5cdFx0XHRcdFx0XHRjb250YWN0cy51bnNoaWZ0KGNvbnRhY3QpO1xuXHRcdFx0XHRcdH1lbHNle1xuXHRcdFx0XHRcdFx0Y29uc29sZS5sb2coYEludmFsaWQgY29udGFjdCBmb3VuZCAtIGNvbnRhY3QgPSAke2NvbnRhY3R9YCk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIHVuaXFCeU9iamVjdChjb250YWN0cyk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiBjb250YWN0cztcblx0fVxuXG5cdGZpbmRBbGxDYXRlZ29yaWVzKCk6IHN0cmluZ1tdIHtcblx0XHQvLyAgY29uc3QgZmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XG5cdFx0Y29uc3QgY2F0ZWdvcmllczogc3RyaW5nW10gPSBbXTtcblxuXHRcdGZ1bmN0aW9uIGV4dHJhY3RTZWNvbmRMZXZlbEZvbGRlcihzdHI6IHN0cmluZyk6IHN0cmluZyB8IG51bGwge1xuXHRcdFx0Y29uc3QgcmVnZXggPSAvXFwvKFteXFwvXSopXFwvLztcblx0XHRcdGNvbnN0IG1hdGNoID0gc3RyLm1hdGNoKHJlZ2V4KTtcblxuXHRcdFx0cmV0dXJuIG1hdGNoID8gbWF0Y2hbMV0gOiBudWxsO1xuXHRcdH1cblxuXHRcdGNvbnN0IGZvbGRlck9yRmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aCh0aGlzLnNldHRpbmdzLnF1ZXN0aW9uc0ZvbGRlcik7XG5cdFx0bGV0IG51bUZvbGRlcnMgPSAwO1xuXG5cdFx0aWYgKGZvbGRlck9yRmlsZSBpbnN0YW5jZW9mIFRGb2xkZXIpIHtcblx0XHRcdGZvciAobGV0IGNoaWxkIG9mIGZvbGRlck9yRmlsZS5jaGlsZHJlbikge1xuXHRcdFx0XHRpZiAoY2hpbGQgaW5zdGFuY2VvZiBURmlsZSkge1xuXHRcdFx0XHRcdC8vIFRvcCBsZXZlbCBRdWVzdGlvbnMgY2F0ZWdvcnkgZmlsZVxuXHRcdFx0XHR9IGVsc2UgeyAvLyBDYXRlZ29yeSBGb2xkZXJcblx0XHRcdFx0XHRjb25zdCBjYXRlZ29yeUZvbGRlciA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChjaGlsZC5wYXRoKVxuXHRcdFx0XHRcdGlmIChjYXRlZ29yeUZvbGRlciBpbnN0YW5jZW9mIFRGb2xkZXIpIHtcblx0XHRcdFx0XHRcdGZvciAobGV0IGlubmVyQ2hpbGQgb2YgY2F0ZWdvcnlGb2xkZXIuY2hpbGRyZW4pIHtcblx0XHRcdFx0XHRcdFx0aWYgKGlubmVyQ2hpbGQgaW5zdGFuY2VvZiBURmlsZSkge1xuXHRcdFx0XHRcdFx0XHRcdGNvbnN0IHN1YnN0cmluZyA9IGV4dHJhY3RTZWNvbmRMZXZlbEZvbGRlcihpbm5lckNoaWxkLnBhdGgpO1xuXHRcdFx0XHRcdFx0XHRcdGlmIChzdWJzdHJpbmcgIT0gbnVsbCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0Y29uc29sZS5sb2coYElORk86IHN1YnN0cmluZyA9ICR7c3Vic3RyaW5nfWApO1xuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKCFjYXRlZ29yaWVzLmNvbnRhaW5zKHN1YnN0cmluZykpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0Y2F0ZWdvcmllcy51bnNoaWZ0KHN1YnN0cmluZyk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdFx0Y29uc29sZS5sb2coYENvdWxkbid0IGV4dHJhY3QgZm9sZGVyIHN1YnN0cmluZyBmcm9tICR7aW5uZXJDaGlsZC5wYXRofWApO1xuXHRcdFx0XHRcdFx0XHRcdH0gLy8gZW5kaWYgc3Vic3RyaW5nXG5cdFx0XHRcdFx0XHRcdH0gLy8gZW5kaWYgaW5uZXJjSElMRFxuXHRcdFx0XHRcdFx0fSAvL2VuZGZvciBpbm5lcmNoaWxkXG5cdFx0XHRcdFx0fSAvL2VuZGlmIGluc3RhbmNlb2YgVEZvbGRlclxuXHRcdFx0XHR9IC8vZW5kaWYgaW5zdGFuY2Ugb2YgVEZpbGVcblxuXHRcdFx0fS8vZW5kZm9yIGNoaWxkIG9mIHRmb2xkZXJcblx0XHRcdGNvbnNvbGUubG9nKGBudW1Gb2xkZXJzPSR7bnVtRm9sZGVyc31gKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29uc29sZS5sb2coYE5PVCBBTiBJTlNUQU5DRSBPRiBURm9sZGVyIGluc3RlYWQgaXQgaXMgJHtmb2xkZXJPckZpbGV9YCk7XG5cdFx0fVxuXHRcblx0XHRyZXR1cm4gY2F0ZWdvcmllcztcblx0fVxuXG5cblxuXHRvbnVubG9hZCgpIHtcblx0XHRjb25zb2xlLmxvZyhcIlVubG9hZGluZyBQZXJ0aW5lbnRRdWVzdGlvbnMgcGx1Z2luLi4uXCIpO1xuXHR9XG5cblxuXHRhc3luYyBsb2FkU2V0dGluZ3MoKSB7XG5cdFx0dGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MsIGF3YWl0IHRoaXMubG9hZERhdGEoKSk7XG5cdH1cblxuXHRhc3luYyBzYXZlU2V0dGluZ3MoKSB7XG5cdFx0YXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcblx0fVxufVxuXG5cblxuY2xhc3MgUGVydGluZW50UXVlc3Rpb25zU3VnZ2VzdE1vZGFsIGV4dGVuZHMgU3VnZ2VzdE1vZGFsPHN0cmluZz4ge1xuXHRjYXRlZ29yaWVzOiBzdHJpbmdbXTtcblx0Y29udGFjdHM6IENvbnRhY3RbXTtcblx0b3V0cHV0Rm9sZGVyOiBzdHJpbmc7XG5cdHF1ZXN0aW9uc0ZvbGRlcjogc3RyaW5nO1xuXHR2YXVsdDogVmF1bHQ7XG5cblxuXHRjb25zdHJ1Y3RvcihhcHA6IEFwcCwgY2F0ZWdvcmllczogc3RyaW5nW10sIGNvbnRhY3RzOiBDb250YWN0W10sIG91dHB1dEZvbGRlcjogc3RyaW5nLCBxdWVzdGlvbnNGb2xkZXI6IHN0cmluZykge1xuXHRcdHN1cGVyKGFwcCk7XG5cdFx0dGhpcy52YXVsdCA9IGFwcC52YXVsdDtcblx0XHR0aGlzLmNhdGVnb3JpZXMgPSBjYXRlZ29yaWVzO1xuXHRcdHRoaXMuY29udGFjdHMgPSBjb250YWN0cztcblx0XHR0aGlzLm91dHB1dEZvbGRlciA9IG91dHB1dEZvbGRlcjtcblx0XHR0aGlzLnF1ZXN0aW9uc0ZvbGRlciA9IHF1ZXN0aW9uc0ZvbGRlcjtcblx0fVxuXHQvLyBSZXR1cm5zIGFsbCBhdmFpbGFibGUgc3VnZ2VzdGlvbnMuXG5cdGdldFN1Z2dlc3Rpb25zKHF1ZXJ5OiBzdHJpbmcpOiBzdHJpbmdbXSB7XG5cdFx0dGhpcy5jYXRlZ29yaWVzLnNvcnQoKTsgLy8gc29ydCBhbmQgZW5zdXJlIEFMTF9DQVRFR09SSUVTIGlzIGZpcnN0IHNlbGVjdGlvblxuXHRcdGlmICh0aGlzLmNhdGVnb3JpZXNbMF0gIT0gQ29uc3RhbnRzLkFMTF9DQVRFR09SSUVTKSB7XG5cdFx0XHRjb25zdCBpbmRleCA9IHRoaXMuY2F0ZWdvcmllcy5pbmRleE9mKENvbnN0YW50cy5BTExfQ0FURUdPUklFUyk7XG5cdFx0XHQvLyBkZWJ1Z2dlcjtcblx0XHRcdC8vIHRoaXMuY2F0ZWdvcmllcy5zcGxpY2UoaW5kZXgsIDEpO1xuXHRcdFx0dGhpcy5jYXRlZ29yaWVzLnVuc2hpZnQoQ29uc3RhbnRzLkFMTF9DQVRFR09SSUVTKTtcblx0XHR9XG5cdFx0cmV0dXJuIHRoaXMuY2F0ZWdvcmllcy5maWx0ZXIoKGNhdCkgPT5cblx0XHRcdGNhdC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHF1ZXJ5LnRvTG93ZXJDYXNlKCkpXG5cdFx0KTtcblx0fVxuXG5cdC8vIFJlbmRlcnMgZWFjaCBzdWdnZXN0aW9uIGl0ZW0uXG5cdHJlbmRlclN1Z2dlc3Rpb24oY2F0OiBzdHJpbmcsIGVsOiBIVE1MRWxlbWVudCkge1xuXHRcdGVsLmNyZWF0ZUVsKFwiZGl2XCIsIHsgdGV4dDogY2F0IH0pO1xuXHRcdC8vICBlbC5jcmVhdGVFbChcInNtYWxsXCIsIHsgdGV4dDogYm9vay5hdXRob3IgfSk7XG5cdH1cblxuXHQvLyBQZXJmb3JtIGFjdGlvbiBvbiB0aGUgc2VsZWN0ZWQgc3VnZ2VzdGlvbi5cblx0YXN5bmMgb25DaG9vc2VTdWdnZXN0aW9uKGNhdDogc3RyaW5nLCBldnQ6IE1vdXNlRXZlbnQgfCBLZXlib2FyZEV2ZW50KSB7XG5cblx0XHR0aGlzLmNyZWF0ZUZvbGRlcih0aGlzLm91dHB1dEZvbGRlcik7XG5cdFx0aWYgKGNhdCAhPSBDb25zdGFudHMuQUxMX0NBVEVHT1JJRVMpIHtcblx0XHRcdHRoaXMuY2F0ZWdvcmllcyA9IFtjYXRdO1xuXHRcdH0gZWxzZSB7XG5cblx0XHRcdHRoaXMuY2F0ZWdvcmllcy5zaGlmdCgpOyAvLyByZW1vdmUgQUxMX0NBVEVHT1JJRVMgYW5kIGl0ZXJhdGUgdGhyb3VnaCBBTEwgY2F0ZWdvcmllc1xuXG5cdFxuXHRcdH1cblx0XHQvLyBGT1JFRUFDSCBRdWVzdGlvbiBDYXRlZ29yeVxuXHRcdGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5jYXRlZ29yaWVzLmxlbmd0aDsgaisrKSB7XG5cdFx0XHRjb25zb2xlLmxvZyhgY2F0ICR7an0gPSAke3RoaXMuY2F0ZWdvcmllc1tqXX1gKTtcblx0XHRcdC8vIEdldCBhbGwgdGhlIHF1ZXN0aW9uc1xuXHRcdFx0bGV0IHRoZVF1ZXN0aW9ucyA9IGF3YWl0IHRoaXMuZ2V0Q2F0ZWdvcnlRdWVzdGlvbnModGhpcy5jYXRlZ29yaWVzW2pdKTtcblxuXHRcdFx0aWYgKHRoZVF1ZXN0aW9ucyAhPSBudWxsKSB7IC8vIE5vIGNhdGVnb3J5IHF1ZXN0aW9ucywgc28gZG9uJ3QgY3JlYXRlIGEgY2F0ZWdvcnkgZm9sZGVyIG9yIG9wdGlvblxuXHRcdFx0XHQvLyBuZWVkIHRoZSBkaXJlY3Rvcnkgc2VwYXJhdG9yIFxuXHRcdFx0XHRjb25zdCB0aGVGb2xkZXIgPSB0aGlzLm91dHB1dEZvbGRlci5jb25jYXQoQ29uc3RhbnRzLk1BQ19GT0xERVJfU0VQQVJBVE9SKS5jb25jYXQodGhpcy5jYXRlZ29yaWVzW2pdKTtcblx0XHRcdFx0dGhpcy5jcmVhdGVGb2xkZXIodGhlRm9sZGVyKTsgLy8gQ3JlYXRlIHRoZSBjYXRlZ29yaWVzXG5cdFx0XHRcdC8vIEZPUkVBQ0ggRW1haWwgQ29udGFjdFxuXG5cdFx0XHRcdGlmICh0aGlzLmNvbnRhY3RzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuY29udGFjdHMubGVuZ3RoOyBpKyspIHtcblxuXHRcdFx0XHRcdFx0Zm9yIChsZXQgayA9IDA7IGsgPCB0aGVRdWVzdGlvbnMubGVuZ3RoOyBrKyspIHtcblxuXHRcdFx0XHRcdFx0XHRsZXQgdGhlUXVlc3Rpb24gPSB0aGVRdWVzdGlvbnNba107XG5cdFx0XHRcdFx0XHRcdHRoaXMud3JpdGVRdWVzdGlvbkZpbGUodGhlUXVlc3Rpb24sIHRoZUZvbGRlciwgdGhpcy5jYXRlZ29yaWVzW2pdLCB0aGlzLmNvbnRhY3RzLmF0KGkpKTtcblxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0gLy9FbmQgRk9SRUFDSCBjb250YWN0XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Zm9yIChsZXQgayA9IDA7IGsgPCB0aGVRdWVzdGlvbnMubGVuZ3RoOyBrKyspIHtcblxuXHRcdFx0XHRcdFx0bGV0IHRoZVF1ZXN0aW9uID0gdGhlUXVlc3Rpb25zW2tdO1xuXHRcdFx0XHRcdFx0dGhpcy53cml0ZVF1ZXN0aW9uRmlsZSh0aGVRdWVzdGlvbiwgdGhlRm9sZGVyLCB0aGlzLmNhdGVnb3JpZXNbal0pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRjb25zb2xlLmxvZyhgQ291bGRuJ3QgcmVhZCBhbnkgZmlsZSBhdCAke3RoaXMucXVlc3Rpb25zRm9sZGVyfSBgKTtcblx0XHRcdH1cblxuXHRcdH0gLy9FbmQgRk9SRUFDSCBjYXRlZ29yeVxuXHR9XG5cblx0YXN5bmMgd3JpdGVRdWVzdGlvbkZpbGUodGhlUXVlc3Rpb246IHN0cmluZywgdGhlRm9sZGVyOiBzdHJpbmcsIGNhdGVnb3J5OiBzdHJpbmcsIGNvbnRhY3Q/OiBDb250YWN0KSB7XG5cdFx0Y29uc3QgdGhlU3ViamVjdCA9IENvbnN0YW50cy5TVUJKRUNUX0dPRVNfSEVSRTtcblx0XHRjb25zdCB0aGVGaWxlRnJvbnRNYXR0ZXIgPSBgLS0tXFxucHVibGlzaDogdHJ1ZVxcbnNlbnQ6IGZhbHNlXFxuY2F0ZWdvcnk6ICR7Y2F0ZWdvcnl9XFxuLS0tXFxuXFxuYDtcblx0XHRjb25zdCB0aGVRdWVzdGlvbkZpbGU6IHN0cmluZ1tdID0gdGhlUXVlc3Rpb24uc3BsaXQoXCJcXG5cIiwgMik7XG5cdFx0Y29uc3QgaW5kZXggPSB0aGVRdWVzdGlvbi5pbmRleE9mKFwiXFxuXCIpOyAvLyBGaXJzdCBsaW5lIGlzIHRoZSBmaWxlbmFtZVxuXHRcdGlmIChpbmRleCAhPSB1bmRlZmluZWQpIHtcblx0XHRcdHRoZVF1ZXN0aW9uID0gdGhlUXVlc3Rpb24uc3Vic3RyaW5nKGluZGV4LCB0aGVRdWVzdGlvbi5sZW5ndGggLSAxKTtcblx0XHRcdGxldCB0aGVCb2R5ID0gXCJcIjtcblx0XHRcdGxldCB0aGVGaWxlTmFtZSA9IFwiXCI7XG5cdFx0XHRpZiAoY29udGFjdCkge1xuXHRcdFx0XHR0aGVCb2R5ID0gYCR7Q29uc3RhbnRzLkZBT30gJHtjb250YWN0LnRpdGxlfSAke2NvbnRhY3QuZmlyc3ROYW1lfSAke2NvbnRhY3QubGFzdE5hbWV9JHt0aGVRdWVzdGlvbkZpbGVbMV19YDtcblx0XHRcdFx0Ly8gQ3JlYXRlIFBlcnRpbmVudCBRdWVzdGlvbnMgRmlsZSB1c2luZyBGaXJzdCBOYW1lIGFuZCBMYXN0IE5hbWVcblx0XHRcdFx0dGhlRmlsZU5hbWUgPSB0aGVGb2xkZXIuY29uY2F0KFwiL1wiKS5jb25jYXQoY29udGFjdC5maXJzdE5hbWUgKyBjb250YWN0Lmxhc3ROYW1lICsgXCItXCIgKyB0aGVRdWVzdGlvbkZpbGVbMF0gKyBcIi5tZFwiKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRoZUJvZHkgPSBgJHtDb25zdGFudHMuRkFPfSAke3RoZVF1ZXN0aW9uRmlsZVsxXX1gO1xuXHRcdFx0XHR0aGVGaWxlTmFtZSA9IHRoZUZvbGRlci5jb25jYXQoXCIvXCIpLmNvbmNhdCh0aGVRdWVzdGlvbkZpbGVbMF0gKyBcIi5tZFwiKTtcblx0XHRcdH1cblxuXHRcdFx0Y29uc3QgdGhlRmlsZUV4aXN0cyA9IGZpbGVFeGlzdHModGhlRmlsZU5hbWUsIHRoaXMuYXBwKTtcblx0XHRcdGlmICghdGhlRmlsZUV4aXN0cykge1xuXHRcdFx0XHQvLyBGaWxlIGRvZXMgbm90IGV4aXN0LCBzbyBjcmVhdGVcblxuXHRcdFx0XHRsZXQgdGhlRmlsZSA9IGF3YWl0IHRoaXMuY3JlYXRlRmlsZSh0aGVGaWxlTmFtZSwgdGhlRmlsZUZyb250TWF0dGVyKTtcblx0XHRcdFx0aWYgKHRoZUZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xuXHRcdFx0XHRcdGxldCB0aGVDb250ZW50ID0gXCJcIjtcblx0XHRcdFx0XHRpZiAoY29udGFjdCkge1xuXHRcdFx0XHRcdFx0dGhlQ29udGVudCA9IChcImBgYGVtYWlsXFxuXCIuY29uY2F0KGB0bzogJHtjb250YWN0LmVtYWlsQWRkcmVzc31cXG5zdWJqZWN0OiAke3RoZVN1YmplY3R9XFxuYm9keTogXFxcIiR7dGhlQm9keX1cXFwiXFxuYCkuY29uY2F0KFwiYGBgXCIpKTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0Ly8gTm8gY29udGFjdCBzbyBqdXN0IGdlbmVyYXRpbmcgYW4gZWFtcGxlIGVtYWlsXG5cdFx0XHRcdFx0XHR0aGVDb250ZW50ID0gKFwiYGBgZW1haWxcXG5cIi5jb25jYXQoYHRvOiBzb21lb25lQGV4YW1wbGUuY29tXFxuc3ViamVjdDogJHt0aGVTdWJqZWN0fVxcbmJvZHk6IFxcXCIke3RoZUJvZHl9XFxcIlxcbmApLmNvbmNhdChcImBgYFwiKSk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMuYXBwLnZhdWx0LmFwcGVuZCh0aGVGaWxlLCB0aGVDb250ZW50KTtcblx0XHRcdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdFx0XHRuZXcgTm90aWNlKCdDb3VsZCBub3QgYXBwZW5kJyk7XG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZyhgQ291bGQgbm90IGFwcGVuZCB0byBmaWxlOiAke3RoZUZpbGVOYW1lfSBkdWUgdG8gJHtlfWApO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHRlbHNlIHtcblx0XHRcdFx0XHRuZXcgTm90aWNlKCdDb3VsZCBub3QgY3JlYXRlIGZpbGUnKTtcblx0XHRcdFx0XHRjb25zb2xlLmxvZyhgRXJyb3IgLSBjb3VsZCBub3QgY3JlYXRlIGZpbGUgZm9yICR7dGhlRmlsZU5hbWV9YCk7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7IC8vIGVuZGlmIGZpbGVFeGlzdHNcblx0XHRcdFx0Ly9GaWxlIGV4aXN0cyAtIGlnbm9yZVxuXHRcdFx0fVxuXHRcdH0gLy8gZW5kaWYgaW5kZXggdW5kZWZpbmVkXG5cblx0fVxuXG5cblxuXHRhc3luYyBjcmVhdGVGaWxlKHRoZUZpbGVQYXRoOiBzdHJpbmcsIGNvbnRlbnQ6IHN0cmluZyk6IFByb21pc2U8VEZpbGUgfCBudWxsPiB7XG5cblx0XHR0cnkge1xuXG5cdFx0XHRjb25zdCB0aGVGaWxlRXhpc3RzID0gZmlsZUV4aXN0cyh0aGVGaWxlUGF0aCwgdGhpcy5hcHApO1xuXHRcdFx0aWYgKHRoZUZpbGVFeGlzdHMpIHtcblx0XHRcdFx0Y29uc29sZS5sb2coYFdBUk5JTkc6ISEhISEhISEhRk9VTkQgRklMRSAke3RoZUZpbGVQYXRofWApO1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0Ly8gTm8gZmlsZSBvciBmb2xkZXIgc28gY3JlYXRlXG5cdFx0XHRjb25zb2xlLmxvZyhgSU5GTzpDcmVhdGluZyBGaWxlICR7dGhlRmlsZVBhdGh9YCk7XG5cdFx0XHRjb25zdCBjcmVhdGVkRmlsZTogVEZpbGUgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5jcmVhdGUodGhlRmlsZVBhdGgsIGNvbnRlbnQpO1xuXHRcdFx0cmV0dXJuIGNyZWF0ZWRGaWxlO1xuXHRcdFx0Ly8gfVxuXHRcdH0gY2F0Y2ggKGUpIHtcblx0XHRcdGNvbnNvbGUubG9nKGUpO1xuXHRcdH1cblx0XHRyZXR1cm4gbnVsbDtcblx0fVxuXHRhc3luYyBjcmVhdGVGb2xkZXIodGhlRm9sZGVyOiBzdHJpbmcpIHtcblx0XHR0cnkge1xuXHRcdFx0aWYgKCFmb2xkZXJFeGlzdHModGhlRm9sZGVyLHRoaXMuYXBwKSl7XG5cdFx0XHRcdGF3YWl0IHRoaXMuYXBwLnZhdWx0LmNyZWF0ZUZvbGRlcih0aGVGb2xkZXIpO1xuXHRcdFx0XHRjb25zb2xlLmxvZyhcIkNyZWF0ZWRcIik7XG5cdFx0XHR9XG5cblx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRjb25zb2xlLmxvZyhlKTtcblx0XHR9XG5cdH1cblxuXHQvLyBnZXRDYXRlZ29yeVF1ZXN0aW9ucyBhZGRzIHRoZSBmaWxlIG5hbWUgYXMgdGhlIGZpcnN0IGxpbmUvZWxlbWVudCBpbiB0aGUgcmV0dXJuIHN0cmluZ1xuXHRhc3luYyBnZXRDYXRlZ29yeVF1ZXN0aW9ucyhjYXRlZ29yeTogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmdbXSB8IG51bGw+IHtcblxuXHRcdHRyeSB7XG5cdFx0XHQvLyBjb25jYXQgdGhlIC8gYXMgYWxsIGZvbGRlcnMgbmVlZCB0byBiZSBkZXZvaWQgb2YgLyBzbGFzaGVzIHRvIHdvcmsgd2l0aCBhYnN0cmFjdEZpbGVQYXRoIGltcGwgSSBoYXZlXG5cdFx0XHRjb25zdCBmb2xkZXJPckZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgodGhpcy5xdWVzdGlvbnNGb2xkZXIuY29uY2F0KENvbnN0YW50cy5NQUNfRk9MREVSX1NFUEFSQVRPUi5jb25jYXQoY2F0ZWdvcnkpKSk7XG5cblx0XHRcdGlmIChmb2xkZXJPckZpbGUgaW5zdGFuY2VvZiBURm9sZGVyKSB7XG5cdFx0XHRcdGNvbnN0IHRoZVF1ZXN0aW9uczogc3RyaW5nW10gPSBbXTtcblx0XHRcdFx0Zm9yIChsZXQgY2hpbGQgb2YgZm9sZGVyT3JGaWxlLmNoaWxkcmVuKSB7XG5cdFx0XHRcdFx0aWYgKGNoaWxkIGluc3RhbmNlb2YgVEZpbGUpIHtcblx0XHRcdFx0XHRcdGxldCB0aGVRdWVzdGlvbkxpbmVzID0gYXdhaXQgdGhpcy5hcHAudmF1bHQuY2FjaGVkUmVhZChjaGlsZCk7XG5cdFx0XHRcdFx0XHRjb25zdCBpbmRleCA9IGNoaWxkLnBhdGgubGFzdEluZGV4T2YoQ29uc3RhbnRzLk1BQ19GT0xERVJfU0VQQVJBVE9SKTtcblx0XHRcdFx0XHRcdGlmIChpbmRleCAhPSB1bmRlZmluZWQpIHtcblxuXHRcdFx0XHRcdFx0XHRsZXQgdGhlUXVlc3Rpb24gPSBjaGlsZC5wYXRoICsgXCJcXG5cIjsgLy8gd2lsbCBhZGQgdG8gbmV3IGZpbGUgbmFtZVxuXHRcdFx0XHRcdFx0XHQvLyBBZGQgMSB0byBpbmRleCB0byBnbyBwYXN0IHRoZSAvIGFuZCByZW1vdmUgNCB0byBnZXQgcmlkIG9mIHRoZSAubWRcblx0XHRcdFx0XHRcdFx0dGhlUXVlc3Rpb24gPSB0aGVRdWVzdGlvbi5zdWJzdHJpbmcoaW5kZXggKyAxLCB0aGVRdWVzdGlvbi5sZW5ndGggLSA0KTsgLy8gRmlyc3QgbGluZSBvZiBpbnRlcmltIGZpbGUgaXMgZmlsZW5hbWVcblxuXHRcdFx0XHRcdFx0XHRjb25zdCBxdWVzdGlvbkxpbmVzID0gdGhlUXVlc3Rpb25MaW5lcy5zcGxpdChcIlxcblwiKTtcblx0XHRcdFx0XHRcdFx0Y29uc3QgbGluZVN0YXJ0ID0gQ29uc3RhbnRzLkVNQUlMX05MLmNvbmNhdChDb25zdGFudHMuRU1BSUxfU09MKTtcblx0XHRcdFx0XHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBxdWVzdGlvbkxpbmVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0XHRcdFx0dGhlUXVlc3Rpb24gKz0gbGluZVN0YXJ0LmNvbmNhdChxdWVzdGlvbkxpbmVzW2ldKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR0aGVRdWVzdGlvbnMudW5zaGlmdCh0aGVRdWVzdGlvbik7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIHRoZVF1ZXN0aW9ucztcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNvbnNvbGUubG9nKGBFeHBlY3RlZCBmb2xkZXIgaW4gZ2V0Q2F0ZWdvcnlRdWVzdGlvbnMgcGFyYW0gYnV0IHNlbnQgJHt0aGlzLnF1ZXN0aW9uc0ZvbGRlci5jb25jYXQoY2F0ZWdvcnkpfWApO1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRjb25zb2xlLmxvZyhlKTtcblx0XHR9XG5cdFx0cmV0dXJuIG51bGw7XG5cblxuXG5cdH1cblxuXHRvbkNsb3NlKCkge1xuXHRcdGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuXHRcdGNvbnRlbnRFbC5lbXB0eSgpO1xuXHR9XG59XG5cbmNsYXNzIFBlcnRpbmVudFNldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcblx0cGx1Z2luOiBQZXJ0aW5lbnRRdWVzdGlvbnM7XG5cblx0Y29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogUGVydGluZW50UXVlc3Rpb25zKSB7XG5cdFx0c3VwZXIoYXBwLCBwbHVnaW4pO1xuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xuXHR9XG5cblx0ZGlzcGxheSgpOiB2b2lkIHtcblx0XHRjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuXG5cdFx0Y29udGFpbmVyRWwuZW1wdHkoKTtcblxuXHRcdGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdoMicsIHsgdGV4dDogJ0dlbmVyYWwgU2V0dGluZ3MnIH0pO1xuXG5cdFx0bmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG5cdFx0XHQuc2V0TmFtZSgnUXVlc3Rpb25zIEZvbGRlcicpXG5cdFx0XHQuc2V0RGVzYygnRW50ZXIgdGhlIEZvbGRlciBMb2NhdGlvbicpXG5cdFx0XHQuYWRkVGV4dCh0ZXh0ID0+IHRleHRcblx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKCdFbnRlciBRdWVzdGlvbnMgRm9sZGVyJylcblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnF1ZXN0aW9uc0ZvbGRlcilcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdGNvbnNvbGUubG9nKCdRdWVzdGlvbnMgTG9jYXRpb246ICcgKyB2YWx1ZSk7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MucXVlc3Rpb25zRm9sZGVyID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pKTtcblxuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuXHRcdFx0LnNldE5hbWUoJ1F1ZXN0aW9ucyBPdXRwdXQgRm9sZGVyJylcblx0XHRcdC5zZXREZXNjKCdFbnRlciB0aGUgUGVydGluZW50IFF1ZXN0aW9ucyBPdXRwdXQgRm9sZGVyIExvY2F0aW9uJylcblx0XHRcdC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuXHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoJ0VudGVyIFBlcnRpbmVudCBRdWVzdGlvbnMgT3V0cHV0IEZvbGRlcicpXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5vdXRwdXRGb2xkZXIpXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHRjb25zb2xlLmxvZygnT3V0cHV0IEZvbGRlciBMb2NhdGlvbjogJyArIHZhbHVlKTtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5vdXRwdXRGb2xkZXIgPSB2YWx1ZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSkpO1xuXG5cdFx0bmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG5cdFx0XHQuc2V0TmFtZShDb25zdGFudHMuQ09OVEFDVFNfSU1QT1JUX0ZJTEUpXG5cdFx0XHQuc2V0RGVzYygnRW50ZXIgdGhlIENvbnRhY3RzIEltcG9ydCBGaWxlIExvY2F0aW9uJylcblx0XHRcdC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuXHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoQ29uc3RhbnRzLkNPTlRBQ1RTX0ZJTEVfTE9DQVRJT04pXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5jb250YWN0c0ZpbGUpXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHRjb25zb2xlLmxvZygnQ29udGFjdHMgRmlsZSBMb2NhdGlvbjogJyArIHZhbHVlKTtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5jb250YWN0c0ZpbGUgPSB2YWx1ZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSkpO1xuXHR9XG59XG5cbiIsICJleHBvcnQgY2xhc3MgQXBwU2V0dGluZ3N7XG4gICAgcHVibGljIHN0YXRpYyBFTUFJTF9OTCA9IGBcXG5cXG5gOy8vIEVtYWlsIG5ldyBsaW5lXG4gICAgcHVibGljIHN0YXRpYyAgRU1BSUxfU09MID0gYCAgYDsgLy9FbWFpbCBzdGFydCBvZiBsaW5lXG4gICAgcHVibGljIHN0YXRpYyBNQUNfRk9MREVSX1NFUEFSQVRPUiA9IGAvYDtcbiAgICBwdWJsaWMgc3RhdGljIEFMTF9DQVRFR09SSUVTID0gXCJBbGwgQ2F0ZWdvcmllc1wiO1xuICAgIHB1YmxpYyBzdGF0aWMgQ1JFQVRFX1BFUlRJTkVOVF9RVUVTVElPTlMgPSAnQ3JlYXRlIFBlcnRpbmVudCBRdWVzdGlvbnMnO1xuICAgIHB1YmxpYyBzdGF0aWMgU1VCSkVDVF9HT0VTX0hFUkUgPSBcIlNVQkpFQ1QgR09FUyBIRVJFXCI7XG4gICAgcHVibGljIHN0YXRpYyBGQU8gPSBcIkZBT1wiO1xuICAgIHB1YmxpYyBzdGF0aWMgQ09OVEFDVFNfRklMRV9MT0NBVElPTiA9ICdFbnRlciBDb250YWN0cyBGaWxlIExvY2F0aW9uJztcbiAgICBwdWJsaWMgc3RhdGljIENPTlRBQ1RTX0lNUE9SVF9GSUxFID0gJ0NvbnRhY3RzIEltcG9ydCBGaWxlJztcblxufSJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxzQkFBZ0o7OztBQ0F6SSxJQUFNLGNBQU4sTUFBaUI7QUFXeEI7QUFYYSxZQUNLLFdBQVc7QUFBQTtBQUFBO0FBQUE7QUFEaEIsWUFFTSxZQUFZO0FBQUE7QUFGbEIsWUFHSyx1QkFBdUI7QUFINUIsWUFJSyxpQkFBaUI7QUFKdEIsWUFLSyw2QkFBNkI7QUFMbEMsWUFNSyxvQkFBb0I7QUFOekIs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
